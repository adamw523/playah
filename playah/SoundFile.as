package playah {	import flash.media.Sound;	import flash.media.SoundChannel;	import flash.net.URLRequest;	import flash.events.Event;	import flash.events.ProgressEvent;	import flash.events.TimerEvent;	public class SoundFile {		private var key:String;		private var sound:Sound;		private var soundChannel:Object = null;		private var position:Number = 0;		private var soundCompleteListenerCallback:Function;				private function soundCompleteListener(e:Event):void {			soundChannel = null;			soundCompleteListenerCallback.call();		}				public function SoundFile(key:String, url:String, loaded:Function, scl:Function):void {			sound = new Sound();			sound.load(new URLRequest(url));			sound.addEventListener(Event.COMPLETE, loaded);			soundCompleteListenerCallback = scl;		}		public function play():void {			if(!soundChannel) {				soundChannel = sound.play(position);				soundChannel.addEventListener(Event.SOUND_COMPLETE, soundCompleteListener);			}		}				public function pause():void {			if(soundChannel) {				position = soundChannel.position;				soundChannel.stop();				soundChannel = null;			}		}				public function stop():void {			position = 0;			if(soundChannel) {				soundChannel.stop();				soundChannel = null;			}		}				private function updatePosition():void {			if(soundChannel) {				position = soundChannel.position;			}		}				public function toJson():String {			updatePosition();						var json : String = '{';			json += '"length": ' + sound.length;			if(sound.length > 0) {				json += ', "loaded_percent": ' +  sound.bytesLoaded / sound.bytesTotal * 100;				json += ', "bytes_total": ' + sound.bytesTotal;				json += ', "position": ' + position;			} else {				json += ', "loaded_percent": ' + 0;			}			json += '}';						return json;		}			}}